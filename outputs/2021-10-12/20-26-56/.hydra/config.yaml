model:
  target: awesome_ssl.models.byol.BYOL
  kwargs:
    encoder_params:
      target: awesome_ssl.models.trunk_models.resnets.resnet50
    projector_params:
      target: awesome_ssl.models.projection_heads.MLP.MLP
      kwargs:
        input_dim: 2048
        hidden_dim: 4096
        output_dim: 256
    predictor_params:
      target: awesome_ssl.models.projection_heads.MLP.MLP
      kwargs:
        input_dim: 256
        hidden_dim: 4096
        output_dim: 256
    tau: 0.004
    accumulate_n_batch: 1
    transform_1:
    - target: kornia.augmentation.CenterCrop
      kwargs:
        size: 224
    - target: kornia.augmentation.RandomHorizontalFlip
    - target: kornia.augmentation.ColorJitter
    - target: kornia.augmentation.RandomGaussianBlur
      args:
      - - 19
        - 19
      - - 1.0
        - 1.0
    - target: kornia.augmentation.RandomSolarize
    transform_2:
    - target: kornia.augmentation.CenterCrop
      kwargs:
        size: 224
    - target: kornia.augmentation.RandomHorizontalFlip
    - target: kornia.augmentation.ColorJitter
    - target: kornia.augmentation.RandomGaussianBlur
      args:
      - - 19
        - 19
      - - 1.0
        - 1.0
    - target: kornia.augmentation.RandomSolarize
    loss_module:
      target: torch.nn.MSELoss
    optimizer_params:
      target: torch.optim.SGD
      kwargs:
        lr: 0.001
        momentum: 0.9
dataset:
  target: awesome_ssl.datasets.folder_dataset.FolderDataset
  kwargs:
    data_path: /mnt/nfs/datasets/imagenet-pytorch
    preprocess_train:
    - target: torchvision.transforms.RandomResizedCrop
      kwargs:
        size: 256
    - target: torchvision.transforms.ToTensor
    - target: torchvision.transforms.Normalize
      kwargs:
        mean:
        - 0.485
        - 0.456
        - 0.406
        std:
        - 0.229
        - 0.224
        - 0.225
    preprocess_val:
    - target: torchvision.transforms.CenterCrop
      kwargs:
        size: 224
    - target: torchvision.transforms.RandomHorizontalFlip
    - target: torchvision.transforms.ToTensor
    - target: torchvision.transforms.Normalize
      kwargs:
        mean:
        - 0.485
        - 0.456
        - 0.406
        std:
        - 0.229
        - 0.224
        - 0.225
    preprocess_test:
    - target: torchvision.transforms.CenterCrop
      kwargs:
        size: 224
    - target: torchvision.transforms.ToTensor
    - target: torchvision.transforms.Normalize
      kwargs:
        mean:
        - 0.485
        - 0.456
        - 0.406
        std:
        - 0.229
        - 0.224
        - 0.225
    batch_size: 100
    train_test_val_dir:
    - train
    - val
    - val
